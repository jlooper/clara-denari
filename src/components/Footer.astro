---
import { translations } from '../i18n/translations.js';
---

<footer class="text-center p-4 text-green-500" style="text-shadow: 0 0 5px rgba(0, 255, 0, 0.5);">
  <p id="footer-text">
  </p>
</footer>

<script define:vars={{ translations }}>
  document.addEventListener('DOMContentLoaded', () => {
    function getCurrentLanguage() {
      return localStorage.getItem('preferred-language') || 'en';
    }

    function getTranslation(key) {
      const currentLang = getCurrentLanguage();
      const fallbackLang = currentLang === 'pt-br' ? 'en' : currentLang;
      const result = translations[key]?.[fallbackLang] || translations[key]?.en || key;
      return result;
    }

    function updateFooterText() {
      const footerElement = document.getElementById('footer-text');
      if (footerElement) {
        const currentYear = new Date().getFullYear();
        const copyrightText = getTranslation('footer.copyright');
        
        // Create the complete HTML with proper styling
        footerElement.innerHTML = `&copy; ${currentYear} <a href="https://cloudinary.com" target="_blank" class="text-green-400 hover:text-green-300 underline transition-colors duration-200">Cloudinary</a>. ${copyrightText}`;
        
        // Add click handler to the about link after a short delay to ensure DOM is ready
        setTimeout(() => {
          const aboutLink = footerElement.querySelector('a[href="about"]');
          if (aboutLink) {
            aboutLink.addEventListener('click', (e) => {
              e.preventDefault();
              if (window.openAboutModal) {
                window.openAboutModal();
              } else {
                console.warn('openAboutModal function not found');
              }
            });
          } else {
            console.warn('About link not found in footer');
          }
        }, 10);
      } else {
        console.warn('Footer element not found');
      }
    }

    // Initial load
    updateFooterText();

    // Listen for language changes
    window.addEventListener('language-changed', updateFooterText);
    document.addEventListener('language-changed', updateFooterText);
  });
</script> 